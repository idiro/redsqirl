<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets">

	<script>
//<![CDATA[
           
	var file;
	function browserSelectOneRadio(radio, name) {

		var inputs = document.getElementsByTagName("input");
		for(var i = inputs.length-1;i>=0;i--){
		    if(inputs[i].getAttribute("type")==="radio"){
		        inputs[i].checked=false;
		    }
		}
		   
	    radio.checked = true;
	    file = name;
	}
	
	function getPathHdfs(p){
		if (!file){
			return p;
		}
		var lastCHar = p.charAt(p.length-1);
		if(lastCHar == "/"){
			return p + file;
		}else{
			return p + "/"+ file;
		}
	}
	
//]]>
</script>

	<a4j:keepAlive beanName="browserHdfsBean" />
	<a4j:keepAlive beanName="canvasModalBean" />

	<h:outputText value="#{messages.label_path}" />
	<h:inputText id="pathOpenFile" label="Path" value="#{browserHdfsBean.path}"	maxlength="255" style="width:395px;" />
	<a4j:commandLink 
	       type="submit" 
	       id="changePathBt" 
	       action="#{browserHdfsBean.changePath}" 
	       reRender="hdfsfsOpenFile,hdfsOpenFileBtn"  >
        <h:graphicImage id="btSearch" value="../image/icons/button-search.gif"
            title='#{messages.button_ok}' />
    </a4j:commandLink>
	<a4j:commandLink action="#{browserHdfsBean.goPrevious}"
		reRender="pathOpenFile,hdfsfsOpenFile,hdfsOpenFileBtn">
		<h:graphicImage id="btPrev" value="../image/icons/button-previous.gif" title='#{messages.HdfsInterface_previous_help}'/>
	</a4j:commandLink>
	<a4j:commandLink action="#{browserHdfsBean.goNext}" reRender="pathOpenFile,hdfsfsOpenFile,hdfsOpenFileBtn">
		<h:graphicImage id="btNext" value="../image/icons/button-next.gif" title='#{messages.HdfsInterface_next_help}'/>
	</a4j:commandLink>
	<br/>
	
	<div style="width:100%; overflow: auto; height: 305px;margin-top:5px;margin-bottom:10px;" >
		
		<rich:extendedDataTable id="hdfsfsOpenFile" value="#{browserHdfsBean.listGrid}" var="item"
			width="100%" style="border:none;"
			onRowMouseOver="this.style.backgroundColor='#F1F1F1'"
			enableContextMenu="false" selectionMode="none"
			onRowMouseOut="this.style.backgroundColor='#{a4jSkin.rowBackgroundColor}'"
			rowClasses="even-row, odd-row">
	
			<f:facet name="header">
				<h:outputText value="File System" />
			</f:facet>
	
			<rich:column style="border-bottom:0px;border-right:0px;" width="32px;">
				<f:facet name="header">
					<h:outputText value="" />
				</f:facet>
				<h:selectOneRadio value="#{item.stringSelectedDestination}"
					onclick="dataTableOpenSelectOneRadio(this, '#{item.name}');">
					<f:selectItem itemValue="true" />
				</h:selectOneRadio>
	
			</rich:column>
			<rich:column sortBy="#{item.name}"
				style="border-bottom:0px;border-right:0px;">
				<f:facet name="header">
					<h:outputText value="Name" />
				</f:facet>
				<a4j:commandLink value="#{item.name}"
					action="#{browserHdfsBean.selectFile}" reRender="pathOpenFile,hdfsfsOpenFile,hdfsOpenFileBtn">
					<f:param name="nameFile" value="#{item.name}" />
				</a4j:commandLink>
			</rich:column>
	
			<rich:columns value="#{browserHdfsBean.keyAsListNameValue}" var="column"
				index="ind" id="column#{ind}"
				style="border-bottom:0px;border-right:0px;">
				<f:facet name="header">
					<h:outputText value="#{column}" />
				</f:facet>
				<h:outputText value="#{item.nameValue[column]}" id="value#{ind}" />
			</rich:columns>
	
		</rich:extendedDataTable>

	</div>
	
	<a4j:commandButton styleClass="greenButton" id="hdfsOpenFileBtn" action="#{canvasModalBean.changePathBrowser}" value="#{messages.button_ok}" oncomplete="#{rich:component('modalPanelBrowserHdfsId')}.hide();" reRender="browserPanel, browserTable1, browserTable2, browserTable1Col1, browserTable1Col2" >
		<a4j:actionparam name="pathFile" value="getPathHdfs('#{browserHdfsBean.path}')" noEscape="true"/>
	</a4j:commandButton>
	
	<a4j:commandButton styleClass="greenButton" value="#{messages.button_cancel}" oncomplete="#{rich:component('modalPanelBrowserHdfsId')}.hide();" />
	
</ui:composition>
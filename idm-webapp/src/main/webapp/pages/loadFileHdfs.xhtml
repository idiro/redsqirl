<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets">

<a4j:loadBundle basename="MessagesResources" var="messages" />

<script>
//<![CDATA[
	var file;
	function dataTableOpenSelectOneRadio(radio, name) {
	    var id = radio.name.substring(radio.name.lastIndexOf(':'));
	    var el = radio.form.elements;
	
	    for (var i = 0; i < el.length; i++) {
	        if (el[i].name.substring(el[i].name.lastIndexOf(':')) == id) {
	            el[i].checked = false;
	        }
	    }
	    radio.checked = true;
	    file = name;
	}
	
	function getPath(p){
		if (!file){
			return p;
		}
		return p + "/"+ file;
	}

	function selectFileLoadHdfs(isFile, nameFile){
    	if (isFile != "true"){
        	updateTableLoadHdfs(nameFile);
    	}
    }
	
//]]>
</script>

	<a4j:status	onstart="jQuery.blockUI({ message: jQuery('#domMessageDivModal') });"
		onerror="jQuery.unblockUI();" onsuccess="jQuery.unblockUI();"
		onstop="jQuery.unblockUI();" />

	<a4j:jsFunction name="refreshHdfsOpenFileTable" action="#{browserHdfsBean.changePath}" reRender="hdfsfsOpenFile"/>

	<a4j:jsFunction name="updateTableLoadHdfs" action="#{browserHdfsBean.selectFile}" reRender="pathOpenFile,hdfsfsOpenFile,hdfsOpenFileBtn">
		<a4j:actionparam name="nameFile" />
	</a4j:jsFunction>


	<h:outputText value="#{messages.label_path}" />
	<h:inputText id="pathOpenFile" label="Path" value="#{browserHdfsBean.path}"
		maxlength="255" style="width:395px;" onkeypress="return enableEnterKey(event, 'changePathLoadHdfsBtn');"/>
		
	<a4j:commandLink id="changePathLoadHdfsBtn" action="#{browserHdfsBean.changePath}" reRender="pathOpenFile,hdfsfsOpenFile,hdfsOpenFileBtn">
		<h:graphicImage value="../image/icons/button-search.gif" title='#{messages.filesystem_change_path}' />
	</a4j:commandLink>
		
	<a4j:commandLink action="#{browserHdfsBean.goPrevious}"
		reRender="pathOpenFile,hdfsfsOpenFile,hdfsOpenFileBtn">
		<h:graphicImage id="btPrev" value="../image/icons/button-previous.gif" title='#{messages.HdfsInterface_previous_help}' />
	</a4j:commandLink>
	<a4j:commandLink action="#{browserHdfsBean.goNext}" reRender="pathOpenFile,hdfsfsOpenFile,hdfsOpenFileBtn">
		<h:graphicImage id="btNext" value="../image/icons/button-next.gif" title='#{messages.HdfsInterface_next_help}' />
	</a4j:commandLink>
	
	<a4j:commandLink action="#{browserHdfsBean.goUp}" reRender="pathOpenFile,hdfsfsOpenFile,hdfsOpenFileBtn">
		<h:graphicImage id="browserHdfsBeanGoup" value="../image/icons/button_up.jpg" title='#{messages.hdfs_goup}' styleClass="fileSystemIcon" />
	</a4j:commandLink>
	
	<br/><br/>
	
	
	<div style="width:590px;height:250px;overflow:auto;" >
	
	   <rich:extendedDataTable id="hdfsfsOpenFile" value="#{browserHdfsBean.listGrid}" var="item"
            width="50px" height="10px"
            onRowMouseOver="this.style.backgroundColor='#F1F1F1'"
            enableContextMenu="false" selectionMode="none"
            onRowMouseOut="this.style.backgroundColor='#{a4jSkin.rowBackgroundColor}'"
            rowClasses="even-row, odd-row">
    
            <rich:column style="border-bottom:0px;border-right:0px;" styleClass="loadTableRadio" width="32px;">
                <f:facet name="header">
					<h:outputText value="" />
				</f:facet>
                <h:selectOneRadio value="#{item.stringSelectedDestination}"
                    onclick="dataTableOpenSelectOneRadio(this, '#{item.name}');">
                    <f:selectItem itemValue="true" />
                </h:selectOneRadio>
            </rich:column>
            
            <rich:column style="border-bottom:0px;border-right:0px;" width="50px;">
				<f:facet name="header">
					<h:outputText value="" />
				</f:facet>
				<h:graphicImage value="../image/icons/button-property.gif" title='#{messages.HdfsInterface_properties_help}' 
					rendered="#{item.file == 'N'}" styleClass="fileSystemIcon" />
				<h:graphicImage value="../image/icons/button-file-icon.png" title='#{messages.HdfsInterface_properties_help}' 
					rendered="#{item.file == 'S'}" styleClass="fileSystemIcon" />
			</rich:column>
            
            <rich:column sortBy="#{item.name}" filterBy="#{item.name}"
                style="border-bottom:0px;border-right:0px;">
                <f:facet name="header">
                    <h:outputText value="Name" />
                </f:facet>
               <a4j:commandLink value="#{item.name}"
					action="#{browserHdfsBean.verifyIfIsFile}"
					oncomplete="selectFileLoadHdfs('#{browserHdfsBean.file}', '#{item.name}')">
					<f:param name="nameFile" value="#{item.name}" />
				</a4j:commandLink>
            </rich:column>
    
            <rich:columns value="#{browserHdfsBean.keyAsListNameValue}" var="column"
                index="ind" id="column#{ind}"
                style="border-bottom:0px;border-right:0px;">
                <f:facet name="header">
                    <h:outputText value="#{column}" />
                </f:facet>
                <h:outputText value="#{item.nameValue[column]}" id="value#{ind}" />
            </rich:columns>
    
        </rich:extendedDataTable>
        

	</div>


	<br />

	<a4j:commandButton id="hdfsOpenFileBtn" styleClass="greenButton" action="#{canvasBean.load}" value="#{messages.button_ok}"
		onclick="#{rich:component('modalLoadWorkflow')}.hide();" 
		rerender="formMenu, errorTable"
		oncomplete="loadWorkflow();">
		<a4j:actionparam value="getPath('#{browserHdfsBean.path}')" assignTo="#{canvasBean.path}" noEscape="true"/>
	</a4j:commandButton>
	
	<a4j:commandButton styleClass="greenButton" value="#{messages.button_cancel}"
		onclick="#{rich:component('modalLoadWorkflow')}.hide();">
	</a4j:commandButton>
	
</ui:composition>